@import "tailwindcss";

/* Viewport height chain — required for flex-1 layouts in Dashboard */
html, body, #root {
  height: 100%;
}

@theme {
  /* Warm color palette: "Clinical Precision meets Warm Humanity" */
  --color-warm-50: #fdf8f0;
  --color-warm-100: #f5ebe0;
  --color-warm-200: #e8d5c0;
  --color-warm-300: #d4b896;
  --color-warm-400: #c49a6c;
  --color-warm-500: #b07d4f;
  --color-warm-600: #9a6740;
  --color-warm-700: #7d5235;
  --color-warm-800: #5f3e2a;
  --color-warm-900: #3d2a1c;

  /* Skill assessment states */
  --color-not-assessed: #9ca3af;
  --color-needs-work: #e8928a;
  --color-developing: #e5b76a;
  --color-solid: #7fb589;

  /* Sage green accent */
  --color-sage-50: #f0f5f1;
  --color-sage-100: #dce8de;
  --color-sage-200: #b8d1bd;
  --color-sage-300: #8fb898;
  --color-sage-400: #6a9e76;
  --color-sage-500: #4f8460;
  --color-sage-600: #3d6a4c;
  --color-sage-700: #31543d;
  --color-sage-800: #273f30;
  --color-sage-900: #1d2e23;

  /* Coral accent */
  --color-coral-50: #fdf2f1;
  --color-coral-100: #fce0dd;
  --color-coral-200: #f5b8b2;
  --color-coral-300: #ec8e85;
  --color-coral-400: #e06b5f;
  --color-coral-500: #d44d3f;
  --color-coral-600: #b63a2e;
  --color-coral-700: #912e24;
  --color-coral-800: #6d231b;
  --color-coral-900: #491813;

  /* Fonts */
  --font-sans: 'Inter', 'system-ui', '-apple-system', sans-serif;
  --font-display: 'Plus Jakarta Sans', 'Inter', sans-serif;
}

/* Base styles */
body {
  font-family: var(--font-sans);
  background-color: var(--color-warm-50);
  color: var(--color-warm-900);
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* ─── Dark Mode ─────────────────────────────────────────────
   Activated by adding class="dark" to <html>.
   Inverts the warm palette so bg-warm-50 becomes dark, etc.
   This means all existing Tailwind classes just work.
   ──────────────────────────────────────────────────────────── */
.dark {
  color-scheme: dark;

  /* Warm palette — inverted for dark backgrounds */
  --color-warm-50: #1c1714;
  --color-warm-100: #2a2320;
  --color-warm-200: #3d332c;
  --color-warm-300: #5a4a3e;
  --color-warm-400: #7d6b5a;
  --color-warm-500: #a08a74;
  --color-warm-600: #bca68e;
  --color-warm-700: #d4c0a8;
  --color-warm-800: #e8dac8;
  --color-warm-900: #f5efe6;

  /* Sage — slightly muted for dark */
  --color-sage-50: #1a2320;
  --color-sage-100: #243330;
  --color-sage-200: #2e4540;
  --color-sage-300: #3d6050;
  --color-sage-400: #4f8460;
  --color-sage-500: #6a9e76;
  --color-sage-600: #8fb898;
  --color-sage-700: #b8d1bd;
  --color-sage-800: #dce8de;
  --color-sage-900: #f0f5f1;

  /* Coral — slightly muted for dark */
  --color-coral-50: #2a1815;
  --color-coral-100: #3d2320;
  --color-coral-200: #5a332e;
  --color-coral-300: #7d4a42;
  --color-coral-400: #c06055;
  --color-coral-500: #d44d3f;
  --color-coral-600: #ec8e85;
  --color-coral-700: #f5b8b2;
  --color-coral-800: #fce0dd;
  --color-coral-900: #fdf2f1;
}

.dark body {
  background-color: var(--color-warm-50);
  color: var(--color-warm-900);
}

/* Dark mode overrides for white backgrounds (bg-white) */
.dark .bg-white {
  background-color: var(--color-warm-100) !important;
}

/* White with opacity modifiers — remap to dark warm-100 */
.dark .bg-white\/95 { background-color: color-mix(in srgb, var(--color-warm-100) 95%, transparent) !important; }
.dark .bg-white\/90 { background-color: color-mix(in srgb, var(--color-warm-100) 90%, transparent) !important; }
.dark .bg-white\/70 { background-color: color-mix(in srgb, var(--color-warm-100) 70%, transparent) !important; }
.dark .bg-white\/60 { background-color: color-mix(in srgb, var(--color-warm-100) 60%, transparent) !important; }
.dark .bg-white\/50 { background-color: color-mix(in srgb, var(--color-warm-100) 50%, transparent) !important; }
.dark .bg-white\/20 { background-color: color-mix(in srgb, var(--color-warm-100) 20%, transparent) !important; }
.dark .bg-white\/10 { background-color: color-mix(in srgb, var(--color-warm-100) 10%, transparent) !important; }

.dark .border-warm-200 {
  border-color: var(--color-warm-200) !important;
}

/* Dark mode for inputs and selects */
.dark select,
.dark input,
.dark textarea {
  background-color: var(--color-warm-100);
  color: var(--color-warm-900);
  border-color: var(--color-warm-300);
}

/* Dark mode for white text on sage buttons — keep readable */
.dark .bg-sage-500 {
  background-color: var(--color-sage-500) !important;
}

/* ─── Dark mode: Off-palette color remapping ──────────────── */
/* Gray → warm palette (for components not on dark cascade backgrounds) */
.dark .bg-gray-100 { background-color: var(--color-warm-200) !important; }
.dark .bg-gray-200 { background-color: var(--color-warm-300) !important; }
.dark .bg-gray-300 { background-color: var(--color-warm-300) !important; }
.dark .text-gray-400 { color: var(--color-warm-500) !important; }
.dark .text-gray-500 { color: var(--color-warm-600) !important; }
.dark .text-gray-600 { color: var(--color-warm-600) !important; }
.dark .border-gray-200 { border-color: var(--color-warm-300) !important; }
.dark .border-gray-300 { border-color: var(--color-warm-300) !important; }

/* Amber → warm caution tones */
.dark .bg-amber-50 { background-color: #3d3020 !important; }
.dark .bg-amber-100 { background-color: #4a3a25 !important; }
.dark .bg-amber-400 { background-color: #b8860b !important; }
.dark .bg-amber-500 { background-color: #d4a017 !important; }
.dark .text-amber-400 { color: #e5c06a !important; }
.dark .text-amber-500 { color: #d4a017 !important; }
.dark .text-amber-600 { color: #e5b76a !important; }
.dark .text-amber-700 { color: #e8c88a !important; }
.dark .text-amber-800 { color: #f0daa8 !important; }
.dark .text-amber-900 { color: #f5efe6 !important; }
.dark .border-amber-100 { border-color: #4a3a25 !important; }
.dark .border-amber-200 { border-color: #5a4a30 !important; }
.dark .border-amber-300 { border-color: #7a6a40 !important; }
.dark .border-amber-400 { border-color: #b8860b !important; }
.dark .border-amber-500 { border-color: #d4a017 !important; }
.dark .ring-amber-400 { --tw-ring-color: #b8860b !important; }

/* Purple → muted violet for AI features */
.dark .text-purple-600 { color: #b39ddb !important; }
.dark .border-l-purple-400 { border-left-color: #9575cd !important; }
.dark .border-l-purple-300 { border-left-color: #b39ddb !important; }

/* Shadows — reduce intensity in dark mode */
.dark .shadow-lg {
  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -4px rgba(0, 0, 0, 0.3) !important;
}
.dark .shadow-xl {
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 8px 10px -6px rgba(0, 0, 0, 0.3) !important;
}
.dark .shadow-sm {
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2) !important;
}

/* Scrollbar-hide utility for horizontal scroll containers */
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* Safe-area padding for iOS home indicator */
@supports (padding-bottom: env(safe-area-inset-bottom)) {
  .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
}

/* Print — always light mode */
@media print {
  @page {
    size: letter;
    margin: 0.5in;
  }

  body {
    background-color: #fff !important;
    color: #000 !important;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  .print\:hidden {
    display: none !important;
  }

  .print\:block {
    display: block !important;
  }

  table {
    page-break-inside: avoid;
  }
}

/* ─── Accessibility Font Scaling ──────────────────────────── */
html {
  font-size: calc(1rem * var(--accessibility-font-scale, 1));
}

/* ─── Accessibility Overrides ─────────────────────────────── */
.a11y-high-contrast {
  --color-warm-50: #ffffff;
  --color-warm-900: #000000;
  --color-warm-500: #333333;
  --color-warm-400: #444444;
  --color-warm-200: #999999;
}

.a11y-reduce-motion * {
  animation-duration: 0s !important;
  transition-duration: 0s !important;
}

/* Respect system-level reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

.a11y-dyslexia {
  letter-spacing: 0.05em;
  word-spacing: 0.1em;
  line-height: 1.8;
}

.a11y-focus *:focus {
  outline: 3px solid #4f8460 !important;
  outline-offset: 2px !important;
}

.a11y-cb-protanopia {
  --color-needs-work: #d4a017;
  --color-developing: #6b8cc7;
  --color-solid: #2d6a4f;
}

.a11y-cb-deuteranopia {
  --color-needs-work: #d4a017;
  --color-developing: #7ba3d9;
  --color-solid: #1a5c3a;
}

.a11y-cb-tritanopia {
  --color-needs-work: #c44536;
  --color-developing: #8b6fc0;
  --color-solid: #2d8a6e;
}

/* ─── Design System Utilities ────────────────────────────── */

/* Consistent card elevation */
.card {
  background-color: white;
  border: 1px solid var(--color-warm-200);
  border-radius: 0.75rem;
  transition: box-shadow 0.2s ease, border-color 0.2s ease;
}

.card:hover {
  border-color: var(--color-warm-300);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

.dark .card {
  background-color: var(--color-warm-100);
  border-color: var(--color-warm-200);
}

.dark .card:hover {
  border-color: var(--color-warm-300);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

/* Consistent focus rings (keyboard-only) */
.focus-ring:focus-visible {
  outline: 2px solid var(--color-sage-500);
  outline-offset: 2px;
  border-radius: 0.375rem;
}

/* Global interactive element focus (keyboard-only) */
button:focus-visible,
a:focus-visible,
[role="button"]:focus-visible,
[role="tab"]:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible {
  outline: 2px solid var(--color-sage-500);
  outline-offset: 2px;
}

/* ─── Cascade Dark Theme Utilities ───────────────────────── */

/* Cascade views use dark backgrounds — ensure text contrast meets WCAG AA (4.5:1) */
.cascade-bg {
  background-color: #12121a;
  color: #e2e0dc;
}

.cascade-text-primary {
  color: #e2e0dc; /* 11.5:1 on #12121a */
}

.cascade-text-secondary {
  color: #a8a4a0; /* 5.2:1 on #12121a — passes WCAG AA */
}

.cascade-text-muted {
  color: #8a8682; /* 4.6:1 on #12121a — passes WCAG AA minimum */
}

.cascade-text {
  color: #9ca3af; /* 6.3:1 on #12121a — replaces text-gray-500 which fails AA at 3.9:1 */
}

/* ─── Smooth Transitions ─────────────────────────────────── */

/* Consistent transition for interactive elements */
.transition-interactive {
  transition: color 0.15s ease, background-color 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease, transform 0.15s ease;
}

/* Micro-interaction for pressable elements */
.pressable:active {
  transform: scale(0.98);
}

/* ─── Selection Colors ───────────────────────────────────── */
::selection {
  background-color: var(--color-sage-200);
  color: var(--color-sage-900);
}

.dark ::selection {
  background-color: var(--color-sage-600);
  color: #fff;
}

/* ─── Header Accent Gradient ─────────────────────────────── */
.header-accent {
  background: linear-gradient(90deg, var(--color-sage-400), var(--color-warm-400), var(--color-coral-400));
  height: 2px;
}
